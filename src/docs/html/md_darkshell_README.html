<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarkRISCV Software Environment: Software</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DarkRISCV Software Environment
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Software </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This directory provides support for DarkRISCV software.</p>
<p>The software is 100% written in C language, is compiled by the GCC and lots of support files (elf, assembler, maps, etc) are produced in order to help debug and/or study the RISCV architecture.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Tips and Tricks</h1>
<p>As long the FPGA has few BRAMs available, we need write the software thinking about preserve memory space. However, sometimes the code does not help us... anyway, is possible check the memory space used by each function in the firmware with the following script: </p><pre class="fragment">awk '{ 
        if($0~/&gt;:/) PTR=$2
        else 
        if($0~/:/) DB[PTR]++ 
      } END { 
        for(i in DB) print DB[i],i 
      }' src/darksocv.lst | sort -nr
</pre><p>The script will calculate how many instructions each funcion needs and will print and sort it, producing something like this: </p><pre class="fragment">456 &lt;main&gt;:
149 &lt;putdx&gt;:
95 &lt;printf&gt;:
62 &lt;strtok&gt;:
62 &lt;gets&gt;:
59 &lt;banner&gt;:
47 &lt;board_name&gt;:
42 &lt;irq_handler&gt;:
...
</pre><p>So, with those information, is possible try optimize better the large funcions.</p>
<p>TODO:</p>
<ul>
<li>add a gdb-stub in order to support UART debug</li>
<li>add a SREC decoder in order to support application upload via UART</li>
<li>split the "stdio" in other files</li>
<li>add more libc features and optimize the existing features </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
